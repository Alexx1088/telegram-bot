# telegram-bot
Телеграм бот для информирования о новых заказах.
Это проект для реализации telegram бота, который будет отслеживать все заказы в заведении и
присылать уведомления о поступлении новых заказов.

## Требования
- PHP 8.1+
- Laravel 10
- MySQL 8
- Composer
- Docker

## Установка и запуск через Docker

### 1. Склонируйте репозиторий, установите зависимости:

git clone https://github.com/Alexx1088/telegram-bot.git

установить зависимости через Composer, сгенерировать application key:

composer install
php artisan key:generate

### 2.  Собрать и запустить контейнеры:

docker-compose up --build -d

### 3.Скопировать файл .env.example в .env

### 4. Проверить настройки базы данных и убедится, что они соответствуют данным из docker-compose.yml

### 5. Выполнить миграции

docker exec -it bot php artisan migrate 

### 6. Администрирование базы данных (веб-приложение Adminer):

Adminer доступен по адресу: http://localhost:8093.

Сервер: db_bot
Логин: root
Пароль: root
База данных: bot

## Настройка телеграм бота
### Создать бота в телеграме
Открыть телеграм, найти Botfather (@botfather). Начать чат с Botfather и использовать команду /newbot,
чтобы создать нового бота. Следуйте подсказкам, и назначте имя для вашего бота (например, Myorderbot).
После того, как бот будет создан, Botfather предоставит вам токен. Скопируйте этот токен.

### Настройка токена бота
Добавьте токен бота в свой файл .env:
TELEGRAM_BOT_TOKEN=your-telegram-bot-token

### Установите вебхук 
Замените https://your-domain.com на свой фактический домен или URL. Запустите следующую команду, 
чтобы установить WebHook:
curl -F "url=https://your-domain.com/api/webhook" https://api.telegram.org/bot<your-telegram-bot-token>/setWebhook

### Проверка вебхука
curl https://api.telegram.org/bot<your-telegram-bot-token>/getWebhookInfo

### Необходимая информация:
Для того, чтобы бот мог подписаться на выбранное заведение, пользователю необходимо
ввести следующие данные:

ID заведения
API key заведения

### Консольная команда для получения нового заказа и отправки уведомления
зайти в докер контейнер "bot", выполнить команду для получения нового заказа и отправки уведомления в телеграм: 
php artisan bot:process-orders

Можно также настроить cron на сервере, для запуска этой команды через scheduler Ларавела
(там уже указан запуск каждые 30 сек.):
* * * * * php /path-to-your-project/artisan schedule:run >> /dev/null 2>&1

## Функциональность бота
    • подписываться на любое количество заведений без ограничений
    • выводить список всех отслеживаемых заведений и удалять выбранные(не нужные) заведения
    • отправка уведомлений о новых заказах   

## Контакты

Если у вас есть вопросы по проекту, вы можете связаться со мной:

telegram: @alexx108
